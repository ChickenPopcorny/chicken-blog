---
title: 📄 IEEE 754
date: 2020-01-30 11:49:55
abbrlink: xp50sskp
categories: 杂七杂八
excerpt: IEEE 754 是美国电气电子工程师学会（IEEE）在 1985 年发布的一个技术标准，它定义了浮点型的有限数值、无限数值和特殊值 NaN 的二进制存储格式。
---

# 📄 IEEE 754

IEEE 754 是美国电气电子工程师学会（IEEE）在 1985 年发布的一个技术标准，它定义了浮点型的有限数值、无限数值和特殊值`NaN`的二进制存储格式。

## 存储格式

以一个 64 位的数据类型（比如 Java 中的`double`或者 JavaScript 中的`Number`）为例，它在内存中的存储格式如下：

![](http://q45cwniav.bkt.clouddn.com/superbed/2020/01/30/5e325bb02fb38b8c3cf7e450.jpg)

然后，对于任意一个数值，它都可以换算成下面的格式，以二进制形式存储：

$$ \Large (-1)^s×2^q×c $$

### 符号位

$s$表示符号，直接对应内存中的符号位，只能为`0`或者`1`。可以看到，当符号位为`0`时，该数值为正数（$(-1)^0$为`1`），反之则为负数。

### 指数位

$q$表示指数，对应内存中的指数位。通过内存可以看出，它的表示范围最小是全部 11 个指数位取`0`时，最大是全部位取`1`时，即$[0,2047]$（$[0,2^{11}-1]$）之间。

但是，指数有正负之分，因此这里设置了一个**偏移量（bias）**，用来移动表示范围。它的计算公式为$bias=2^{k-1}-1$，其中$k$为指数位的位数，是固定值。

- 当数据格式为 64 位时，$k=11$
- 当数据格式为 32 位时，$k=8$

这样将表示范围与偏移量相减，相当于将表示范围的数轴向左移动了一半的距离，从而出现正负指数各一半的情况。此时的$bias=2^{11-1}-1=1023$，因此指数$q$实际的表示范围在$(-1023,1024)$（全`0`和全`1`有另外的作用），即$[-1022,1023]$之间，对应的指数位分别是$00000000001$和$11111111110$。

### 尾数位

$c$表示尾数，对应内存中的小数位，由 1 个隐藏位和 52 个其它位组成。由于指数位只能取整数，因此必须要尾数位才能真正的表示小数。

隐藏位用来表示尾数位是否大于`1`，直接当作十进制即可。也就是说，如果该位为`0`，那么尾数位一定是`0.x`，如果该位为`1`，那么尾数位一定是`1.x`。

其它位则是通过**定点数表示法**转换成十进制小数值，从左到右依次为$2^{-1}$、$2^{-2}$，依次类推。例如，隐藏位为`1`，其它位为`011000...`，转换后为$0×2^{-1}+1×2^{-2}+1×2^{-3}=0.375$，考虑隐藏位之后，尾数位最终为`1.375`。

### 特殊值

到目前为止，还有几个特殊值没法表示。因此使用尾数位结合之前指数位预留的两种情况（全`0`和全`1`），来表示这些值：

- 指数位全是`0`，尾数位全是`0`，表示`±0`（因为符号位还在）
- 指数位全是`0`，尾数位不全是`0`，表示**非规格化的值**，此时指数位的全`0`表示十进制的最小值`-1022`
- 指数位全是`1`，尾数位全是`0`，表示$\pm\infty$
- 指数位全是`1`，尾数位不全是`0`，表示`NaN`

> *参考资料*
> * [Java 与 IEEE754 浅浅谈](https://blog.csdn.net/u011679955/article/details/52750345)
> * [细说 JavaScript 七种数据类型](https://www.cnblogs.com/onepixel/p/5140944.html)
> * [IEEE 754 Calculator](http://weitz.de/ieee/)