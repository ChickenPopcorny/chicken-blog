---
title: 计算机网络笔记之07 💻 应用层
date: 2020-01-19 10:16:58
abbrlink: dzta2ga7
tags: 计算机网络
categories: 计算机网络
excerpt: 应用层主要是由若干相互独立的服务和协议所构成的，每个服务或协议可以协同工作从而为计算机上的应用程序提供网络服务。
---

# 计算机网络笔记之07 💻 应用层

> 施工中...修改时间

应用层主要是由若干相互独立的服务和协议所构成的，每个服务或协议可以协同工作从而为计算机上的应用程序提供网络服务。

## DNS

用户（客户端）与互联网上的其它主机（服务器）通信时，必须知道对方的 IP 地址，但是 IP 地址由纯数字组成，非常难以记忆。因此为了既方便计算机处理，又方便用户识别记忆，域名系统 DNS（Domain Name System）应运而生。它可以将一个域名解析成一段 IP 地址，用户在使用域名访问服务器之前，需要先访问 DNS 服务器，从中获得该主机域名对应的 IP 地址，然后再使用 IP 地址访问指定的服务器。

当然，为了提高访问速度，减少网络资源浪费，系统会将访问过的网站 DNS 存放到系统缓存中（在命令行输入`ipconfig /displaydns`可以查看）。然后，用户也可以在本地的 hosts 文件中（`c:\Windows\System32\drivers\etc\hosts`）配置某个域名对应的实际 IP 地址。如果上述两个步骤均没有找到，那么系统才会访问 DNS 服务器以获取域名对应的 IP 地址。

### 域名

早期的互联网其实就是以一个简短的单词作为 IP 地址的名称的，但是随着网站越来越多，一个单独的名称已经不能满足需求了。于是互联网就采用了目前这种树状的具有层级的命名方法，其中的每一层称为一个**域**，一个完整的域名由多个层级即多个域组成，因此才称为域名（Domain Name）。

顶级域名大部分由国家或特定机构持有，之后也开放了普通公司机构的申请权利，但是费用极高（几十万美元）。常见的`.com`、`.cn`、`.edu`、`.org`等均是顶级域名。

二级域名位于顶级域名的下一层，个人和公司均可以申请，价格也非常便宜（指没有被注册过的），我们平时需要付费购买的基本限于二级域名。如`google.com`中的`google`就是二级域名。

由此继续向左延伸，也可以继续有三级域名、四级域名等，但是域名层级越深，记忆难度越大，使用的人也相对较少。

每个域名均是独一无二的，因此个人在申请域名之前，需要查询该域名是否已经被人注册，如果是他人已经注册的域名，也可以通过协商的方式进行购买并转让。

### 记录类型

购买域名之后，还需要为域名配置解析，也就是在 DNS 服务器登记。记录的类型有很多种，包括：

- `A`记录：最常见的记录类型（A 表示 address），根据域名返回对应的 IPv4 地址
- `CNAME`记录：别名记录，当查询该域名（如`testa.com`）时，返回另一个域名（如`testb.com`），再通过`testb.com`查询对应的`A`记录，从而获得对应的 IP 地址。注意，使用`CNAME`记录配置的记录值（别名）必须在本域名之下有`A`记录，不能解析到其他人的域名
- `AAAA`记录：根据域名返回对应的 IPv6 地址

如果你申请了一个域名如`muyumiao.com`，想要用户使用`muyumiao.com`和`www.muyumiao.com`两种方式访问，那么需要配置`A`记录中对应的主机记录，也就是主机名称。第一种方式主机名为空，第二种方式主机名为`www`，因此对应的主机记录分别为`@`（表示主机名为空）和`www`。而`A`记录的记录值填写的是主机的 IP 地址。最下方的 TTL 表示该记录的缓存时间，也就是多长时间之后，系统会再次去 DNS 服务器获取 IP 地址，而不是本地缓存。

![](http://cdn.yesuanzao.cn/superbed/2020/02/17/5e4a89ad48b86553ee204a52.jpg)

## URL

URL（Uniform Resource Locator，统一资源定位符）类似于现实中的居住地址，可以用来定位互联网上某个资源的位置。它的具体格式如下：

![](https://pic2.superbed.cn/item/5df98ab676085c32897f4821.jpg)

> 严格来说，URL 属于 URI（Uniform Resource Identifier，统一资源标识符）的一种，表示通过地址来描述一个资源。但是，要描述资源不仅只有地址一种方式，也可以通过名称来描述。这种描述方式称为 URN（Uniform Resource Name，统一资源名称），比如常见的书籍国际标准书号 ISBN 就是 URN 的一种。
> 
> 总的来说，URI 包括了 URL 和 URN 两种具体描述方式，只是在 Web 中 URL 更加常见。有些文档或书籍中也会以 URI 来表述，但是其含义与 URL 其实是一致的。

**协议**标明了通信双方需要共同遵循的格式约定，这里主要使用的是应用层的 HTTP、HTTPS 或 FTP 协议。

**服务器地址**包括了主机名称和域名，已经在上文 DNS 中详细讨论过。

**端口号**



#### 路径

这一段通常表示资源在服务器的物理路径，但是，返回的内容其实全凭服务器如何解析，因为本质上来说，它只是一段普通的字符串而已。这种根据路径来选择资源的过程，称为**页面的路由**。

路径分为绝对路径和相对路径，在一些 HTML 标签中，如果请求资源与当前资源的服务器、端口等均相同，那么这些部分是可以省略的。如果路径以`/`开头，那么表示从服务器的根路径开始定位；否则的话，则是以当前资源的路径开始定位。

对于相对路径，`./`表示的是当前路径，多数情况下与省略不写是一样的，而`../`表示上一级路径。

```html
<!-- 当前资源为 http://www.test.com/public/index.html -->

<!-- 绝对路径，相当于 http://www.test.com/test.html -->
<a href="/test.html">
<!-- 相对路径，相当于 http://www.test.com/public/test.html -->
<a href="test.html">
```

#### 查询参数

客户端发起请求的时候同时也可以携带参数，其中一种方式就是通过 URL 的`?`部分传递。这些参数以`=`分隔，前面为参数名，后面为参数值。多对参数以`&`分隔。

#### 哈希值

哈希可以用来进一步定位页面上的某一个部分，只需要在元素上添加`id`属性，使哈希与该属性值一致即可。注意，**如果只有哈希部分发生了改变，那么浏览器是不会再次向服务器发起请求的**，这是之后前端路由技术的原理。

## HTTP

HTTP 协议是互联网通信主要使用的协议，通过它传递的数据称为报文。

### 报文

此时浏览器会将客户端的信息打成一个包（称为请求报文），把它通过通道发送到服务器端。但是，服务器必须知道这个包的格式才能拆包，从中提取出想要的信息。因此，双方会以约定好的格式来发送内容，这一格式就是 **HTTP 协议**。

请求报文和接下来的响应报文必须按照一定的格式来保存，这样双方才能从中解析出需要的数据。

请求报文分为三个部分，由上到下为**请求行**、**请求头**与**请求体**，其中请求头包含了客户端的额外信息（浏览器版本、Cookie 等），请求体为发送到服务端的参数（比如注册信息、商品的当前页数等）。具体格式如下：

![](https://ae01.alicdn.com/kf/Hd17c0d12a978482d91c4f8ccb0753924W.jpg)

服务器上通常都会安装类似于 Apache 的服务器软件，用来处理来自浏览器的请求。由于 HTTP 协议是通过`80`端口传输的，因此默认情况下 Apache 会监听服务器的`80`端口，一旦发现了请求，则会根据请求文件的扩展名找到对应的 MIME Type（比如 Apache 的`mime.types`文件），判断用户请求的是静态资源（图片、CSS / JS 文件等）还是动态页面。如果是静态资源，那么直接找到相应文件；如果是动态页面，则需要调用该类型文件的处理工具（比如 PHP），将其转换成浏览器可以识别的 HTML。

请求方法分为`GET`和`POST`两种，`GET`通常使用地址栏后`?`部分传递参数，如`http://127.0.0.1:3000?id=233&page=1`，其中`id=233&page=1`就是参数。而`POST`会将请求参数放在请求体中，打开浏览器控制台工具可以查看：

![](https://ae01.alicdn.com/kf/Hfc43f3b5e3af4a689bcd1b39fef32f20I.jpg)

然后，服务器也会将返回的数据打成一个包（称为响应报文），同样包含了服务器端的信息、返回的页面内容，并通过`80`端口返回。

响应报文同样分为三个部分，由上到下为**响应行**、**响应头**与**响应体**，其中响应头包含了服务端的额外信息，请求体通常为返回的页面内容。具体格式如下：

![](https://ae01.alicdn.com/kf/Hf54474f596b94396ad2ceb34fe016c6ev.jpg)

其中常见的状态码有（位于响应行）：

* `200`：请求成功
* `404`：资源没有找到
* `500`：服务器端有语法错误
* `400`：客户端请求有语法错误

常见的 MIME 类型有（位于响应头的`content-type`键值对）：

* HTML 文件：`text/html`
* CSS 文件：`text/css`
* JavaScript 文件：`application/javascript`
* 图片文件：`image/jpeg`
* JSON：`application/json`

打开浏览器，从开发者工具找到`Network`一项，刷新一个页面，就可以从中看到请求报文和响应报文的信息。

![](https://ae01.alicdn.com/kf/H453e66e2c19c451a984484a9c31d4672H.jpg)

### Cookie

Cookie 是浏览器保存数据的一种方式，数据以键值对形式存储，可以供客户端或服务端调用。在 Chrome 控制台点击`Application`标签可以查看本地所有的 Cookie，可以看到，Cookie 是按照域名分类的，也就是说，一个域名下的网页无法访问其它域名下的 Cookie。并且，当用户提交表单时，浏览器会自动将本域的 Cookie 提交到服务端。

![](https://pic2.superbed.cn/item/5dfdb65a76085c3289a52e15.jpg)